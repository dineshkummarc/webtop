(function(d,E,I){function J(H,F,z,j,A){var r={x:H,y:F},s={x:H,y:F};function k(){return"M"+r.x+" "+r.y+" L"+s.x+" "+s.y}var B,t=z.path(k());t.o({stroke:"#"+Math.round(16777215*Math.random()).toString(16),"stroke-width":2});t.J(function(){this.remove();l.t.m(B[0],B[1])});return{D:function(i,o){r.x=i;r.y=o;t.o("path",k());return this},v:function(i,o){s.x=i;s.y=o;t.o("path",k());return this},m:function(){t.remove()},f:function(){return j},n:function(){return A},R:function(i){B=i}}}var l=function(){function H(f,
b,c){x=f.pageX;y=f.pageY;h=new J(x,y,t,b,c);o.i("mousemove",function(e,g){e=g||e;x=e.pageX;y=e.pageY;h&&h.v(x,y)});o.N(function(){if(h){h.m();h=null}});return h}function F(f,b,c){if(f.length){b=b.P();c=c.P();c=[b.left,b.top,c.left,c.top];for(var e=0;e<f.length;e++){b=f[e];if(b.C)b.u?f[e].k.D(c[0]+10,c[1]+15):f[e].k.v(c[0]+10,c[1]+15);else b.u?f[e].k.D(c[2]+15,c[3]+15):f[e].k.v(c[2]+15,c[3]+15)}}}function z(f,b){for(var c=0,e=i.length;c<e;c++)if(i[c][0]==f&&i[c][1]==b)return true;return false}var j=
[],A=[],r=[],s=0,k=E.document,B=parseInt,t,i=[],o,h;function G(f){f.preventDefault()}consts={U:25,Y:50,T:1,V:2,W:0,X:1,$:3,Z:4,aa:5};d(k).qa(function(){d(k.body).i("selectstart",G);t=new Raphael("canvas",0,0,d(E).width(),d(E).height());o=d("#canvas")});return{B:function(f){var b=j[f];return{close:function(){if(b){k.body.removeChild(b.c);delete j[f];s--}l.A.z(l.b("NEW_TASK"))},q:function(){if(b.g!==l.b("MAXIMIZED")){var c=d(E).height()-l.b("TASK_BAR_HEIGHT")+"px";d(b.c).a({width:"100%",height:c,left:"0px",
top:"0px"});d("div.window-inner",b.c).a({height:c,width:"100%"});b.g=l.b("MAXIMIZED");b.c.style.zIndex=s++;d(b.c).draggable("option","disabled",true).s("option","disabled",true)}else{this.restore();d(b.c).draggable("option","disabled",false).s("option","disabled",false)}},M:function(){d(b.c).e("fast");b.g*=-1},focus:function(){d(b.c).show("fast");b.c.style.zIndex=s++},restore:function(){this.focus();if(b.g===l.b("MAXIMIZED")){d(b.c).a({width:b.d.w,height:b.d.p+"px",left:b.d.x+"px",top:b.d.y+"px"});
var c=d("div.window-inner",b.c),e=c.j("full")?0:l.b("HEADER_HEIGHT");c.a({width:b.d.w,height:b.d.p-e+"px"});b.g=l.b("DEFAULT")}b.g=Math.abs(b.g)},t:{pa:function(c){for(var e,g=0,m=i.length,p;g<m;g++)if(i[g][0]===f){p=0;for(e=r[i[g][1]];p<e.length;p++)e[p](c)}},ja:function(c){if(r[f]===I)r[f]=[];r[f].push(c)}},id:f}},ra:function(f){var b=k.createElement("div"),c=d(b),e=APPLIST[f],g=j.length,m,p,u=[];if(e.sa){var n=this.G.K(f);if(n){this.B(n[0]).restore();return}}b.id="app"+g;c.h("window").a({width:e.width,
height:e.height+"px",zIndex:e.da?1E3:s++}).ia((e.t!==false?em({"class":"input"})+em({"class":"output"}):"")+div({"class":"window-header"},strong(e.title),span(a({"class":"min"}),a({"class":"max"}),a({"class":"close"})))+div({"class":"window-inner loading"}));e.a&&c.a(e.a);j.push({id:f,c:b,d:{w:e.width,p:e.height,x:10,y:10},g:l.b("DEFAULT")});f=k.createElement("iframe");var C=d("div.window-inner",b);d(f).o({frameBorder:"0",ba:"true",src:e.src+"?c="+(new Date).getTime()}).e();C.append(f).a("height",
e.height-l.b("HEADER_HEIGHT")+"px");if(e.ha===false){d("div.window-header",b).h("hidden");C.h("full").a("height",e.height)}k.body.appendChild(b);var v=this.B(j.length-1);d("a.min",b).click(function(){v.M()});d("a.max",b).click(function(){v.q()});d("a.close",b).click(function(){v.close()});n=f.contentWindow||f.contentDocument;var D=d(f);n.F=l;n.S=v;D.load(function(){C.r("loading");D.show()});d("div.window-header",b).i("dragstart",G).i("selectstart",G).i("mousedown",function(){v.focus()}).J(function(){v.q()});
if(e.Q!==false){b=d("em",b);m=d(b[0]);p=d(b[1]);b.i("dragstart",G).i("selectstart",G).l(function(q){var w=d(this).j("input");h=H(q,g,w);u.push({k:h,C:w,u:true})}).N(function(){o.va("mousemove");var q,w=true;if(h){if(h.f()==g)w=false;if(d(this).j("input")){if(z(h.f(),g)||h.n())w=false;q=[h.f(),g]}else{if(z(g,h.f())||!h.n())w=false;q=[g,h.f()]}if(w){i.push(q);u.push({k:h,C:d(this).j("input"),u:false});h.R(q)}else h.m();h=null}}).ma(function(q){o.ua("mousemove",q)}).oa(function(){if(h&&h.f()!==g&&(d(this).j("input")&&
!(z(h.f(),g)||h.n())||d(this).j("output")&&!(z(g,h.f())||!h.n())))d(this).h("over")}).na(function(){d(this).r("over")})}e.draggable!==false&&c.draggable({handle:"div.window-header",scroll:false,I:"document",start:function(){D.e();d(this).h("drag");o.e()},stop:function(){o.show();D.show();d(this).r("drag");var q=[B(d(this).a("left")),B(d(this).a("top")),d(this).width()];j[g].d.x=q[0];j[g].d.y=q[1];F(u,m,p)}});e.s!==false&&c.s({I:"document",fa:true,ca:C,start:function(){D.e();d(this).h("drag");o.e();
j[g].g===l.b("MAXIMIZED")&&v.q()},stop:function(){D.show();d(this).r("drag");o.show();j[g].d.w=d(this).a("width");j[g].d.p=parseInt(d(this).a("height"),10);F(u,m,p)}});l.A.z(l.b("NEW_TASK"))},G:{K:function(f){var b=[],c=0,e;for(e=j.length;c<e;c++)j[c]&&j[c].id===f&&b.push(c);return b.length>0?b:false},ga:function(){return j},ta:function(f){return APPLIST[f]}},A:{ea:function(f,b,c){if(A[b]===I)A[b]=[];A[b].push({O:f,L:c})},z:function(f,b){var c=A[f],e=0,g,m;if(c!==I)for(g=c.length;e<g;e++){m=c[e];
m.L.apply(m.O,[b])}}},b:function(f){return consts[f]},t:{m:function(f,b){for(var c=0,e=i.length;c<e;c++)if(i[c][0]===f&&i[c][1]===b){i.splice(c,1);break}},create:function(f,b){i.push([f,b])}},Q:function(){return i},H:function(f,b,c){var e=k.createDocumentFragment();if(!c){c=k.createElement("ul");k.body.appendChild(c);d(c).h("ui-context-menu").e();b.oncontextmenu=function(){return false};d(b).l(function(n){if(n.which===3){n.preventDefault();d(c).show();return false}})}for(var g in f){var m=k.createElement("li");
d(m).text(g).click(function(){d("ul:first",this).show("fast").l(function(C){C.stopPropagation()});var n=this;d(this).parent().l(function(){d("ul",n).e("fast")});d(k).l(function(){d("ul:first",n).e("fast");d(n).parent().e("fast")});return false}).l(function(n){n.stopPropagation()});e.appendChild(m);var p=f[g];if(d.ka(p))m.onclick=p;else if(d.la(p)){var u=k.createElement("ul");u.setAttribute("class","ui-menu-bar-root");m.appendChild(u);this.H(p,b,u)}}c.appendChild(e)}}}();E.F=l})(jQuery,window);